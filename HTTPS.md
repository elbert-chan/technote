### 1. 对称加密
加密、解密双方使用同一个密钥。
- 优点：加密速度快。
- 缺点：加、解密双方很难保证密钥传输过程中的安全性。

### 2. 非对称加密
公私密钥对，公钥加密的数据，只有私钥可以解密。私钥加密的数据，只有公钥可以解密。
- 优点：保护好自己的私钥，公钥随便传输。
- 缺点：加密速度慢。

### 3. 如何保证信息安全？

1）信息的保密性（加密算法）
> 虽然第三方可以截获消息，但是他无法解密。

信息的保密性我们可以使用对称加密和非对称加密来完成，使用对称加密来完成，速度相对非对称加密很快，但是存在一个安全问题，密钥如何传递？由此通用的方法是使用非对称加密+对称加密来完成。客户端使用 **公钥** 对 **对称加密的密钥** 进行加密，然后传递给服务端，服务端使用 **私钥** 进行解密确认密钥，开始传输数据。

非对称加密机制传送对称加密的秘钥。然后加解密双方使用同一把钥匙加、解密信息。

2）身份识别（数字签名）
> 接收方需要确定消息的发送方身份。

在信息传输的过程中，我们通常需要验证信息发送方的身份。首先发送方会把自己的 **公钥** 发送给所有可能的接收方，然后发送方把自己的 **消息** 使用 **私钥** 加密后形成 **签名** 发送给接收方，因为接收方只能用发送方的公钥解密，自然就验证了发送方的身份。

接收方维护着一个公钥“钥匙串”不止一把公钥，能用谁的公钥解开就证明消息发送是谁。

3）信息的完整性（信息摘要）
> 相同摘要算法，内容不变，得到相同摘要值。

信息传输的途中，我们的信息很有可能被第三方劫持篡改，所以我们需要保证信息的完整性。通用方法是使用散列算法如 SHA1，MD5 将传输内容 hash 一次获得 hash 值，即 **摘要**。发送方对 **消息** 计算得出摘要后，使用（秘钥对中的一个）秘钥对摘要进行加密得到 **签名**，将签名和消息一同发给接收方。接收方使用（秘钥对中的另一个）秘钥对签名进行解密，然后得到摘要值 digest1，自己对消息计算摘要得到 digest2, 如果两者相同，则信息是完整的，未被篡改过。

### 4. 为甚需要 CA 证书？
如果公钥钥匙串被篡改，是不是就给了第三方伪装成你钥匙串中某个公钥主人的机会？钥匙串的本质是公钥与公钥主人的映射关系，而这个信息又是允许公开的。那完全可以把这个信息的管理职责交给一个信任的机构——证书中心（CA）。
公钥主人去 CA 为自己的公钥做认证，CA 用自己的私钥对公钥和所属人的一些相关信息一起加密，生成 **数字证书**。以后发送方在发送信息（**消息体** + **签名**）时只需要把证书一同发送给接收方，接收方使用 CA 的公钥解密证书，得到 **发送方公钥**，再通过发送方公钥可对签名验签，即证明发送方身份。同时得到 **摘要** 可进一步验证消息是否被篡改。

### 5. 如何签署 CA 证书？

1. 生成 **CAPrivateKey** (**CA 私钥**)，同时它可以生成 **CAPublicKey** (**CA 公钥**)；
2. 准备 **CATemplate** (**CA 证书模版**)；
3. 创建 **CACertDER** (**DER 格式编码的证书**) `CACertDER = CATemplate + ParentTemplate + CAPublicKey + CAPrivateKey`；
4. 对 CACertDER 和 CAPrivateKey 分别进行 **PEM 编码** 得到 **CAPem** 和 **CAPrivateKeyPem** 以便对其他证书进行签名；

作为签署其他证书的根证书，它在第三步中 CATemplate 与 ParentTemplate 都使用自己的 CA 证书模版，即**自签名**。

## 参考：
- [https://www.wosign.com/News/news_2018101101.htm](https://www.wosign.com/News/news_2018101101.htm)
- [https://doc.uniontech.com/docs/16q8Mwj97eUnyRk7](https://doc.uniontech.com/docs/16q8Mwj97eUnyRk7)
- [create sign x509 certificates in golang](https://medium.com/@shaneutt/create-sign-x509-certificates-in-golang-8ac4ae49f903)
